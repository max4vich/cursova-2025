# Troubleshooting: "Can't reach database server"

–Ø–∫—â–æ –≤–∏ –æ—Ç—Ä–∏–º—É—î—Ç–µ –ø–æ–º–∏–ª–∫—É `Can't reach database server at el3ctric-max777george-4f8c.l.aivencloud.com:16733`, –≤–∏–∫–æ–Ω–∞–π—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏:

## ‚úÖ –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ Firewall –≤ Aiven (–ù–ê–ô–í–ê–ñ–õ–ò–í–Ü–®–ï!)

**–¶–µ –Ω–∞–π—á–∞—Å—Ç—ñ—à–∞ –ø—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∏!**

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ [Aiven Console](https://console.aiven.io/)
2. –û–±–µ—Ä—ñ—Ç—å –≤–∞—à –ø—Ä–æ–µ–∫—Ç
3. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –≤–∞—à MySQL —Å–µ—Ä–≤—ñ—Å
4. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ **Settings** ‚Üí **IP whitelist** (–∞–±–æ **Security** ‚Üí **IP whitelist**)
5. **–î–æ–¥–∞–π—Ç–µ –∞–±–æ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –ø—Ä–∞–≤–∏–ª–∞: `0.0.0.0/0`**
   - –¶–µ –¥–æ–∑–≤–æ–ª–∏—Ç—å –∑'—î–¥–Ω–∞–Ω–Ω—è –∑ –±—É–¥—å-—è–∫–∏—Ö IP –∞–¥—Ä–µ—Å
   - –ê–±–æ –≤–∏ –º–æ–∂–µ—Ç–µ –¥–æ–¥–∞—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ IP –∞–¥—Ä–µ—Å–∏ Vercel (–º–µ–Ω—à –Ω–∞–¥—ñ–π–Ω–æ)
6. –ó–±–µ—Ä–µ–∂—ñ—Ç—å –∑–º—ñ–Ω–∏

**–Ø–∫—â–æ IP whitelist –ø–æ—Ä–æ–∂–Ω—ñ–π –∞–±–æ –Ω–µ –º—ñ—Å—Ç–∏—Ç—å `0.0.0.0/0`, –∑'—î–¥–Ω–∞–Ω–Ω—è –±—É–¥—É—Ç—å –±–ª–æ–∫—É–≤–∞—Ç–∏—Å—è!**

## ‚úÖ –ö—Ä–æ–∫ 2: –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å—Ç–∞—Ç—É—Å –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

1. –í Aiven Console –ø–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ –≤–∞—à–æ–≥–æ MySQL —Å–µ—Ä–≤—ñ—Å—É
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å—Ç–∞—Ç—É—Å - –≤—ñ–Ω –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ **"RUNNING"** (–∑–µ–ª–µ–Ω–∏–π —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä)
3. –Ø–∫—â–æ –±–∞–∑–∞ –¥–∞–Ω–∏—Ö —É sleep —Ä–µ–∂–∏–º—ñ –∞–±–æ –∑—É–ø–∏–Ω–µ–Ω–∞, –∑–∞–ø—É—Å—Ç—ñ—Ç—å —ó—ó

## ‚úÖ –ö—Ä–æ–∫ 3: –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ Connection String –Ω–∞ Vercel

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ [Vercel Dashboard](https://vercel.com/)
2. –û–±–µ—Ä—ñ—Ç—å –≤–∞—à –ø—Ä–æ–µ–∫—Ç
3. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ **Settings** ‚Üí **Environment Variables**
4. –ó–Ω–∞–π–¥—ñ—Ç—å `DATABASE_URL`
5. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤—ñ–Ω –º–∞—î –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç:

```
mysql://avnadmin:–í–ê–®_–ü–ê–†–û–õ–¨@el3ctric-max777george-4f8c.l.aivencloud.com:16733/–ù–ê–ó–í–ê_–ë–î?ssl-mode=REQUIRED&connect_timeout=60
```

–ê–±–æ —Å–ø—Ä–æ–±—É–π—Ç–µ:

```
mysql://avnadmin:–í–ê–®_–ü–ê–†–û–õ–¨@el3ctric-max777george-4f8c.l.aivencloud.com:16733/–ù–ê–ó–í–ê_–ë–î?sslaccept=strict
```

6. **–í–ê–ñ–õ–ò–í–û:** –ü—ñ—Å–ª—è –∑–º—ñ–Ω–∏ –∑–º—ñ–Ω–Ω–∏—Ö –æ—Ç–æ—á–µ–Ω–Ω—è, –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –∑—Ä–æ–±—ñ—Ç—å **–Ω–æ–≤–∏–π deployment**!

## ‚úÖ –ö—Ä–æ–∫ 4: –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ—Å—Ç—å –¥–∞–Ω–∏—Ö –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è

–í Aiven Console:

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –≤–∞—à MySQL —Å–µ—Ä–≤—ñ—Å ‚Üí **Overview**
2. –°–∫–æ–ø—ñ—é–π—Ç–µ **Connection information** –∞–±–æ **Connection URI**
3. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ:
   - ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∏–π **username** (–∑–∞–∑–≤–∏—á–∞–π `avnadmin`)
   - ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∏–π **password** (—Å–∫–æ–ø—ñ—é–π—Ç–µ –∑ Aiven)
   - ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∏–π **host** (–ø–æ–≤–Ω–∏–π —Ö–æ—Å—Ç –∑ `.l.aivencloud.com`)
   - ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∏–π **port** (16733)
   - ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—É **–Ω–∞–∑–≤—É –±–∞–∑–∏ –¥–∞–Ω–∏—Ö** (–∑–∞–∑–≤–∏—á–∞–π `defaultdb`)

## ‚úÖ –ö—Ä–æ–∫ 5: –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ health check endpoint

–ü—ñ—Å–ª—è deployment –Ω–∞ Vercel:

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ `https://–≤–∞—à-–¥–æ–º–µ–Ω.vercel.app/health/db`
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –≤—ñ–¥–ø–æ–≤—ñ–¥—å:
   - –Ø–∫—â–æ `"database": "connected"` - –≤—Å–µ –ø—Ä–∞—Ü—é—î! ‚úÖ
   - –Ø–∫—â–æ `"database": "disconnected"` - –¥–∏–≤—ñ—Ç—å—Å—è –¥–µ—Ç–∞–ª—ñ –ø–æ–º–∏–ª–∫–∏

## ‚úÖ –ö—Ä–æ–∫ 6: –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ –Ω–∞ Vercel

1. –í Vercel Dashboard ‚Üí –≤–∞—à –ø—Ä–æ–µ–∫—Ç ‚Üí **Deployments**
2. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –æ—Å—Ç–∞–Ω–Ω—ñ–π deployment
3. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ **Functions** ‚Üí –∑–Ω–∞–π–¥—ñ—Ç—å –≤–∞—à API function
4. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –¥–µ—Ç–∞–ª—å–Ω–∏—Ö –ø–æ–º–∏–ª–æ–∫

## üîç –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —á–µ—Ä–µ–∑ Aiven

–í Aiven Console:

1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ –≤–∞—à–æ–≥–æ MySQL —Å–µ—Ä–≤—ñ—Å—É ‚Üí **Logs**
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ —î —Å–ø—Ä–æ–±–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è
3. –Ø–∫—â–æ —Å–ø—Ä–æ–± –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –Ω–µ–º–∞—î - –ø—Ä–æ–±–ª–µ–º–∞ –≤ firewall –∞–±–æ network
4. –Ø–∫—â–æ —î —Å–ø—Ä–æ–±–∏, –∞–ª–µ –≤–æ–Ω–∏ –≤—ñ–¥—Ö–∏–ª—è—é—Ç—å—Å—è - –ø—Ä–æ–±–ª–µ–º–∞ –≤ credentials –∞–±–æ SSL

## üìù –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω–∏–π —Ä—è–¥–æ–∫ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)

–Ø–∫—â–æ —É –≤–∞—Å —î –¥–æ—Å—Ç—É–ø –¥–æ –º–∞—à–∏–Ω–∏ –∑ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—é –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è:

```bash
# –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –¥–æ—Å—Ç—É–ø–Ω—ñ—Å—Ç—å —Ö–æ—Å—Ç–∞
ping el3ctric-max777george-4f8c.l.aivencloud.com

# –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –¥–æ—Å—Ç—É–ø–Ω—ñ—Å—Ç—å –ø–æ—Ä—Ç—É (–ø–æ—Ç—Ä–µ–±—É—î mysql client)
mysql -h el3ctric-max777george-4f8c.l.aivencloud.com -P 16733 -u avnadmin -p
```

## ‚ö†Ô∏è –ß–∞—Å—Ç—ñ –ø–æ–º–∏–ª–∫–∏

1. **"Can't reach database server"** + –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π `.env` = **Firewall –ø—Ä–æ–±–ª–µ–º–∞** (–ö—Ä–æ–∫ 1)
2. **"Access denied"** = –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ñ credentials
3. **"SSL connection required"** = –í—ñ–¥—Å—É—Ç–Ω—ñ SSL –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –≤ connection string
4. **–¢–∞–π–º–∞—É—Ç–∏** = –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö —É sleep —Ä–µ–∂–∏–º—ñ –∞–±–æ network –ø—Ä–æ–±–ª–µ–º–∏

## üöÄ –®–≤–∏–¥–∫–µ –≤–∏—Ä—ñ—à–µ–Ω–Ω—è (—è–∫—â–æ –Ω—ñ—á–æ–≥–æ –Ω–µ –¥–æ–ø–æ–º–∞–≥–∞—î)

1. –í Aiven: –î–æ–¥–∞–π—Ç–µ `0.0.0.0/0` –¥–æ IP whitelist
2. –í Vercel: –û–Ω–æ–≤—ñ—Ç—å `DATABASE_URL` –∑ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–º–∏ SSL –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
3. –ó—Ä–æ–±—ñ—Ç—å –Ω–æ–≤–∏–π deployment –Ω–∞ Vercel
4. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ `/health/db` endpoint

---

**–Ø–∫—â–æ –ø—Ä–æ–±–ª–µ–º–∞ –≤—Å–µ —â–µ –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –ø—ñ—Å–ª—è –≤—Å—ñ—Ö –∫—Ä–æ–∫—ñ–≤:**

1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –ø—Ä–∞—Ü—é—î –±–∞–∑–∞ –¥–∞–Ω–∏—Ö –ª–æ–∫–∞–ª—å–Ω–æ –∑ —Ç–∏–º–∏ –∂ credentials
2. –°–ø—Ä–æ–±—É–π—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤—É –±–∞–∑—É –¥–∞–Ω–∏—Ö –≤ Aiven –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –Ω–µ –ø–µ—Ä–µ–≤–∏—â–µ–Ω–æ –ª—ñ–º—ñ—Ç–∏ Aiven account (—è–∫—â–æ free tier)
